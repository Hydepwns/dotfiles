# DROO's tmux config - Modern and minimal
# =============================================================================

# -----------------------------------------------------------------------------
# General Settings
# -----------------------------------------------------------------------------

set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -g mouse on
set -g history-limit 50000
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g set-clipboard on
set -sg escape-time 0
set -g focus-events on
setw -g aggressive-resize on

# -----------------------------------------------------------------------------
# Prefix Key - Ctrl+a (like screen)
# -----------------------------------------------------------------------------

unbind C-b
set -g prefix C-a
bind C-a send-prefix

# -----------------------------------------------------------------------------
# Key Bindings
# -----------------------------------------------------------------------------

# Reload config
bind r source-file ~/.tmux.conf \; display "Config reloaded"

# Split panes with | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Alt+arrow pane navigation (no prefix)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Shift+arrow window navigation (no prefix)
bind -n S-Left previous-window
bind -n S-Right next-window

# Pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Quick pane cycling
bind -r Tab select-pane -t :.+

# Kill pane/window without confirm
bind x kill-pane
bind X kill-window

# Swap windows
bind -r "<" swap-window -d -t -1
bind -r ">" swap-window -d -t +1

# -----------------------------------------------------------------------------
# Copy Mode (vi style)
# -----------------------------------------------------------------------------

setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind -T copy-mode-vi Escape send-keys -X cancel

{{ if eq .chezmoi.os "darwin" -}}
# macOS clipboard
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"
{{ else -}}
# Linux clipboard
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -selection clipboard"
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection clipboard"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -selection clipboard"
{{ end -}}

# -----------------------------------------------------------------------------
# {{ .theme.name }} Theme
# -----------------------------------------------------------------------------

# Pane borders
set -g pane-border-style "fg={{ .theme.border }}"
set -g pane-active-border-style "fg={{ .theme.accent }}"

# Status bar
set -g status-position bottom
set -g status-justify left
set -g status-style "bg={{ .theme.bg }},fg={{ .theme.fg }}"

# Status left - session name
set -g status-left-length 30
set -g status-left "#[fg={{ .theme.bg }},bg={{ .theme.accent }},bold] #S #[fg={{ .theme.accent }},bg={{ .theme.bg }}]"

# Status right - date/time
set -g status-right-length 50
set -g status-right "#[fg={{ .theme.border }}]#[fg={{ .theme.fg }},bg={{ .theme.border }}] %H:%M #[fg={{ .theme.green }}]#[fg={{ .theme.bg }},bg={{ .theme.green }},bold] %d-%b "

# Window status
setw -g window-status-format "#[fg={{ .theme.border }},bg={{ .theme.bg }}] #I:#W "
setw -g window-status-current-format "#[fg={{ .theme.bg }},bg={{ .theme.accent2 }}]#[fg={{ .theme.bg }},bg={{ .theme.accent2 }},bold] #I:#W #[fg={{ .theme.accent2 }},bg={{ .theme.bg }}]"

# Message style
set -g message-style "fg={{ .theme.bg }},bg={{ .theme.yellow }},bold"
set -g message-command-style "fg={{ .theme.bg }},bg={{ .theme.yellow }}"

# Mode style (selection)
setw -g mode-style "fg={{ .theme.bg }},bg={{ .theme.accent }},bold"

# Clock
setw -g clock-mode-colour "{{ .theme.green }}"

# -----------------------------------------------------------------------------
# Session Management
# -----------------------------------------------------------------------------

# Quick session switching
bind s choose-tree -sZ
bind S choose-session

# Create new session
bind N new-session

# -----------------------------------------------------------------------------
# Plugins (TPM) - Optional
# -----------------------------------------------------------------------------

# To use plugins, install TPM first:
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# List of plugins
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TPM (keep at bottom)
# run '~/.tmux/plugins/tpm/tpm'
